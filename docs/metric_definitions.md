# Metric Definitions

## Revenue Metrics

### Monthly Recurring Revenue (MRR)
- **Definition**: Sum of all active subscription amounts normalized to monthly billing
- **Formula**: `SUM(subscription_amount WHERE status = 'active')`
- **Source**: [fct_subscriptions_monthly.sql](../models/marts/finance/fct_subscriptions_monthly.sql)
- **Used In**: Dashboard, Customer Health Score

### Lifetime Value (LTV)
- **Definition**: Total revenue generated by a customer across all invoices
- **Formula**: `SUM(invoice_amount WHERE status = 'PAID')`
- **Source**: [int_customer_metrics.sql](../models/intermediate/int_customer_metrics.sql)

### Average Revenue Per Ticket
- **Definition**: Revenue divided by number of removal tickets
- **Formula**: `total_revenue / total_tickets`
- **Source**: [int_subscriptions_enriched.sql](../models/intermediate/int_subscriptions_enriched.sql)

## Churn Metrics

### Churn Rate (Monthly)
- **Definition**: Percentage of subscriptions cancelled in a given month
- **Formula**: `cancelled_subscriptions / (active_subscriptions + cancelled_subscriptions)`
- **Source**: [mart_subscription_metrics.sql](../models/marts/finance/mart_subscription_metrics.sql)
- **Note**: AUD subscriptions historically show 42.86% churn vs USD 16.67%

### Customer Churn Rate
- **Definition**: Percentage of customer's subscriptions that have churned
- **Formula**: `churned_subscription_count / lifetime_subscription_count`
- **Source**: [int_customer_metrics.sql](../models/intermediate/int_customer_metrics.sql)

## Usage Metrics

### Ticket Success Rate
- **Definition**: Percentage of completed tickets that were successful
- **Formula**: `successful_tickets / (successful_tickets + unsuccessful_tickets)`
- **Source**: [int_ticket_success_rates.sql](../models/intermediate/int_ticket_success_rates.sql)
- **Benchmarks**:
  - Google: 27.3%
  - Glassdoor: 31.6%
  - Other: 20.3%
  - Overall: 26.6%

### Days to Completion
- **Definition**: Average days from ticket creation to successful removal
- **Formula**: `AVG(DATEDIFF(successfully_removed_date, created_at))`
- **Source**: [fct_removal_tickets.sql](../models/marts/operations/fct_removal_tickets.sql)

## Health Metrics

### Customer Health Score
- **Definition**: Composite score (0-100) indicating customer health
- **Formula**: 
  ```sql
  (invoice_recency_score: 40 points) +
  (mrr_score: 30 points) +
  (usage_score: 20 points) +
  (product_diversity_score: 10 points)
  ```
- **Source**: [int_customer_metrics.sql](../models/intermediate/int_customer_metrics.sql)
- **Interpretation**:
  - 70-100: Healthy
  - 40-69: Monitor
  - 0-39: At Risk

### Risk Category
- **Definition**: Categorical risk assessment based on health score and activity
- **Values**:
  - **Healthy**: health_score >= 70
  - **Monitor**: health_score 40-69
  - **Medium Risk**: health_score < 40
  - **High Risk**: No activity in 90+ days
  - **Churned**: No active subscriptions
- **Source**: [mart_customer_health.sql](../models/marts/core/mart_customer_health.sql)

## Customer Segments

### Segment Definitions
- **Enterprise**: MRR >= $1,000
- **Mid-Market**: MRR >= $500
- **SMB**: MRR >= $100
- **Starter**: MRR < $100
- **Churned**: No active subscriptions

## Product Metrics

### Retainer vs WatchDog
- **Retainer**: Flat fee unlimited removal model
  - 40 subscriptions (29 active, 11 cancelled)
  - $252K revenue last 6 months
  - 91,721 tickets (26.6% success rate)
  - No per-ticket billing

- **WatchDog**: Pay-per-removal model
  - Basic: Lower monthly fee + per-removal charges
  - Premium: Higher monthly fee + per-removal charges
  - Billing via invoice line items (ticket_id linkage)

## Data Quality Notes

### Known Issues
1. **Missing Product IDs**: 28% of invoice line items lack product_id
2. **Status Spelling**: Database uses British spelling 'cancelled' (not 'canceled')
3. **Subscription-Invoice Linkage**: Some cancelled subscriptions have recent paid invoices
4. **Zero Success Rate**: 14/15 top Retainer customers show 0% success rate (likely data quality issue)

### Filters Applied
- **Subscriptions**: start_date >= 2024-01-01
- **Invoices**: created >= 2025-01-01
- **Tickets**: Sampled (every 10th row, last 6 months, max 50K rows)
